#!/bin/sh

# -a search for artist instead of album
# -r set 'random on'
# -z search for albumartist instead of album
while getopts ":arz" Option
do
  case $Option in
    a) lookFor=artist ;;
		r) random=on ;;
    z) lookFor=albumartist ;;
    \:)
      echo "Option -${OPTARG} requires an argument, aborting" >&2
      exit 1
    ;;
    *)
      echo "Unknown option -${OPTARG}, aborting" >&2
      exit 1
    ;;
  esac
done

shift $(($OPTIND - 1))

lookFor=${lookFor:-album}
current="${*:-$(mpc -f %${lookFor}% -q current)}"
[ -z "${current}" ] && exit
# [ -n "${__DEBUG}" ] && echo ${current} && mpc find ${lookFor} "${current}"  && exit
mpc | grep -qe '^\[playing' && mpc crop || mpc clear
mpc consume on
mpc random ${random:-off}
mpc single off
mpc find ${lookFor} "${current}" | mpc add
mpc play
musicresume
